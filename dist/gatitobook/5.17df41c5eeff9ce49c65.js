(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{WiWa:function(t,e,i){"use strict";i.r(e),i.d(e,"AnimaisModule",function(){return et});var n=i("PCNd"),r=i("SVse"),o=i("s7LF"),a=i("nYR2"),s=i("IheW"),c=i("8Y7J"),l=i("LRne"),b=i("HDdC"),u=i("7o/Q");class m{constructor(t){this.value=t}call(t,e){return e.subscribe(new p(t,this.value))}}class p extends u.a{constructor(t,e){super(t),this.value=e}_next(t){this.destination.next(this.value)}}var d=i("JIr8"),f=i("AytR"),h=i("4/Zf");const v=f.a.apiURL;let g=(()=>{class t{constructor(t,e){this.http=t,this.tokenService=e}listaDoUsuario(t){return this.http.get(`${v}/${t}/photos`)}buscaPorID(t){return this.http.get(`${v}/photos/${t}`)}excluiAnimal(t){return this.http.delete(`${v}/photos/${t}`)}curtir(t){return this.http.post(`${v}/photos/${t}/like`,{},{observe:"response"}).pipe(t=>t.lift(new m(!0)),Object(d.a)(t=>"304"===t.status?Object(l.a)(!1):function(t,e){return new b.a(e=>e.error(t))}(t)))}upLoad(t,e,i){const n=new FormData;return n.append("description",t),n.append("allowComments",e?"true":"false"),n.append("imageFile",i),this.http.post(v+"/photos/upload",n,{observe:"events",reportProgress:!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(s.b),c.Ob(h.a))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var I=i("iInd"),x=i("E1ld");const J=f.a.apiURL;let K=(()=>{class t{constructor(){this.urlOriginal="",this.descricao=""}set url(t){this.urlOriginal=t.startsWith("data")?t:`${J}/imgs/${t}`}get url(){return this.urlOriginal}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Bb({type:t,selectors:[["app-animal"]],inputs:{descricao:"descricao",url:"url"},decls:1,vars:2,consts:[[1,"img-thumbnail",3,"src","alt"]],template:function(t,e){1&t&&c.Ib(0,"img",0),2&t&&c.Zb("src",e.url,c.fc)("alt",e.descricao)},styles:[""]}),t})();function w(t,e){1&t&&c.Ib(0,"app-mensagem",18)}function y(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div",6),c.Kb(1,"button",13),c.Rb("click",function(){return c.ec(t),c.dc(4).click()}),c.Ib(2,"i",14),c.Jb(),c.Kb(3,"input",15,16),c.Rb("change",function(e){return c.ec(t),c.Tb().gravaArquivo(e.target)}),c.Jb(),c.hc(5,w,1,0,"app-mensagem",17),c.Jb()}if(2&t){const t=c.Tb();let e=null;c.xb(5),c.Zb("ngIf",!(null==(e=t.formularioAnimal.get("file"))||null==e.errors||!e.errors.required))}}function k(t,e){if(1&t&&c.Ib(0,"app-animal",19),2&t){const t=c.Tb();c.Zb("url",t.preview)}}function j(t,e){1&t&&c.Ib(0,"app-mensagem",20)}function O(t,e){if(1&t&&(c.Kb(0,"div"),c.Kb(1,"button",21),c.jc(2," Enviar "),c.Jb(),c.Kb(3,"a",22),c.jc(4," Cancelar "),c.Jb(),c.Jb()),2&t){const t=c.Tb();c.xb(1),c.Zb("disabled",t.formularioAnimal.invalid)}}function C(t,e){if(1&t&&(c.Kb(0,"div",23),c.jc(1),c.Jb()),2&t){const t=c.Tb();c.xb(1),c.lc(" Percentual de upload ",t.percentualConcluido," ")}}let Z=(()=>{class t{constructor(t,e,i){this.animaisService=t,this.formBuilder=e,this.router=i,this.percentualConcluido=0}ngOnInit(){this.formularioAnimal=this.formBuilder.group({file:["",o.m.required],description:["",o.m.maxLength(300)],allowComments:[!0]})}upLoad(){var t,e,i,n;const r=null!==(e=null===(t=this.formularioAnimal.get("allowComments"))||void 0===t?void 0:t.value)&&void 0!==e&&e,o=null!==(n=null===(i=this.formularioAnimal.get("description"))||void 0===i?void 0:i.value)&&void 0!==n?n:"";this.animaisService.upLoad(o,r,this.file).pipe(Object(a.a)(()=>this.router.navigate(["animais"]))).subscribe(t=>{var e;if(t.type==s.d.UploadProgress){const i=null!==(e=t.total)&&void 0!==e?e:1;this.percentualConcluido=Math.round(t.loaded/i*100)}},t=>console.log(t))}gravaArquivo(t){const[e]=null==t?void 0:t.files;this.file=e;const i=new FileReader;i.onload=t=>this.preview=t.target.result,i.readAsDataURL(e)}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(g),c.Hb(o.c),c.Hb(I.b))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-novo-animal"]],decls:17,vars:6,consts:[[1,"container"],[1,"row",3,"formGroup","submit"],[1,"col-md-6","text-center"],["class","form-group",4,"ngIf","ngIfElse"],["previewImage",""],[1,"col-md-6"],[1,"form-group"],["formControlName","description","placeholder","Descri\xe7\xe3o do animal",1,"form-control","form-control-sm"],["mensagem","Tamanho m\xe1ximo do campo \xe9 de 300 caracteres",4,"ngIf"],[1,"text-muted"],["type","checkbox","formControlName","allowComments"],[4,"ngIf","ngIfElse"],["uploaddiv",""],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-image","fa-4x","align-middle"],["type","file","hidden","","formControlName","file","accept","image/*",3,"change"],["fileInput",""],["mensagem","Por favor selecione a foto",4,"ngIf"],["mensagem","Por favor selecione a foto"],["title","Preview",3,"url"],["mensagem","Tamanho m\xe1ximo do campo \xe9 de 300 caracteres"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],["routerLink","['animais']",1,"btn","btn-secondary","btn-block"],[1,"text-center","display-4"]],template:function(t,e){if(1&t&&(c.Kb(0,"div",0),c.Kb(1,"form",1),c.Rb("submit",function(){return e.upLoad()}),c.Kb(2,"div",2),c.hc(3,y,6,1,"div",3),c.hc(4,k,1,1,"ng-template",null,4,c.ic),c.Kb(6,"div",5),c.Kb(7,"div",6),c.Ib(8,"textarea",7),c.hc(9,j,1,0,"app-mensagem",8),c.Jb(),c.Kb(10,"div",6),c.Kb(11,"label",9),c.jc(12," Permite coment\xe1rios "),c.Ib(13,"input",10),c.Jb(),c.Jb(),c.hc(14,O,5,1,"div",11),c.hc(15,C,2,1,"ng-template",null,12,c.ic),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t){const t=c.dc(5),i=c.dc(16);let n=null;c.xb(1),c.Zb("formGroup",e.formularioAnimal),c.xb(2),c.Zb("ngIf",!e.preview)("ngIfElse",t),c.xb(6),c.Zb("ngIf",!(null==(n=e.formularioAnimal.get("description"))||null==n.errors||!n.errors.maxlength)),c.xb(5),c.Zb("ngIf",!e.percentualConcluido)("ngIfElse",i)}},directives:[o.n,o.h,o.e,r.l,o.b,o.g,o.d,o.a,x.a,K,I.c],styles:[""]}),t})();var $=i("eIep"),F=i("vkgz");const L=f.a.apiURL;let R=(()=>{class t{constructor(t){this.http=t}buscaComentario(t){return this.http.get(`${L}/photos/${t}/comments`)}incluiComentario(t,e){return this.http.post(`${L}/photos/${t}/comments`,{commentText:e})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(s.b))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function S(t,e){if(1&t&&(c.Kb(0,"li"),c.Kb(1,"p",10),c.jc(2),c.Jb(),c.Kb(3,"em"),c.jc(4),c.Ub(5,"date"),c.Jb(),c.Kb(6,"p",11),c.jc(7),c.Jb(),c.Jb()),2&t){const t=e.$implicit;c.xb(2),c.kc(t.userName),c.xb(2),c.kc(c.Wb(5,3,t.date,"dd-MM-yyyy HH:mm")),c.xb(3),c.kc(t.text)}}function T(t,e){1&t&&c.Ib(0,"app-mensagem",12)}function A(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div"),c.Kb(1,"ul",1),c.hc(2,S,8,6,"li",2),c.Jb(),c.Kb(3,"div",3),c.Kb(4,"form",4),c.Rb("submit",function(){return c.ec(t),c.Tb().gravar()}),c.Kb(5,"div",5),c.Ib(6,"textarea",6),c.Kb(7,"div",7),c.Kb(8,"button",8),c.jc(9," Publicar "),c.Jb(),c.Jb(),c.Jb(),c.hc(10,T,1,0,"app-mensagem",9),c.Jb(),c.Jb(),c.Jb()}if(2&t){const t=e.ngIf,i=c.Tb();let n=null;c.xb(2),c.Zb("ngForOf",t),c.xb(2),c.Zb("formGroup",i.comentarioForm),c.xb(4),c.Zb("disabled",i.comentarioForm.invalid),c.xb(2),c.Zb("ngIf",!(null==(n=i.comentarioForm.get("comentario"))||null==n.errors||!n.errors.maxLength))}}let D=(()=>{class t{constructor(t,e){this.comentariosService=t,this.formBuilder=e}ngOnInit(){this.comentarios$=this.comentariosService.buscaComentario(this.id),this.comentarioForm=this.formBuilder.group({comentario:["",o.m.maxLength(300)]})}gravar(){var t,e;const i=null!==(e=null===(t=this.comentarioForm.get("comentario"))||void 0===t?void 0:t.value)&&void 0!==e?e:"";this.comentarios$=this.comentariosService.incluiComentario(this.id,i).pipe(Object($.a)(()=>this.comentariosService.buscaComentario(this.id)),Object(F.a)(()=>{this.comentarioForm.reset(),alert("Comentario Salvo.")}))}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(R),c.Hb(o.c))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-comentarios"]],inputs:{id:"id"},decls:2,vars:3,consts:[[4,"ngIf"],[1,"list-unstyled","comentario-list"],[4,"ngFor","ngForOf"],[1,"mt-4"],[3,"formGroup","submit"],[1,"input-group"],["formControlName","comentario",1,"form-control"],[1,"input-group-append"],[1,"btn","btn-primary","pull-left",3,"disabled"],["mensagem","Tamanho m\xe1ximo de 300 caracteres",4,"ngIf"],[1,"text-dark","font-weight-bold","mr-1"],[1,"break-word","mb-2"],["mensagem","Tamanho m\xe1ximo de 300 caracteres"]],template:function(t,e){1&t&&(c.hc(0,A,11,4,"div",0),c.Ub(1,"async")),2&t&&c.Zb("ngIf",c.Vb(1,1,e.comentarios$))},directives:[r.l,r.k,o.n,o.h,o.e,o.b,o.g,o.d,x.a],pipes:[r.b,r.e],styles:[".comentario-list[_ngcontent-%COMP%]{height:50vh;overflow-y:auto}"]}),t})();function P(t,e){if(1&t&&c.Ib(0,"app-comentarios",12),2&t){const t=c.Tb(2);c.Zb("id",t.animalId)}}function E(t,e){1&t&&(c.Kb(0,"p"),c.jc(1,"Usu\xe1rio n\xe3o pode comentar nessa foto"),c.Jb())}function H(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div",1),c.Kb(1,"div",2),c.Kb(2,"div",3),c.Ib(3,"app-animal",4),c.Jb(),c.Kb(4,"div",5),c.Kb(5,"small"),c.Kb(6,"p",6),c.jc(7),c.Jb(),c.Kb(8,"i",7),c.Rb("click",function(){return c.ec(t),c.Tb().curtir()}),c.jc(9),c.Jb(),c.Kb(10,"i",8),c.jc(11),c.Jb(),c.Kb(12,"i",9),c.Rb("click",function(){return c.ec(t),c.Tb().excluir()}),c.Jb(),c.Jb(),c.hc(13,P,1,1,"app-comentarios",10),c.hc(14,E,2,0,"ng-template",null,11,c.ic),c.Jb(),c.Jb(),c.Jb()}if(2&t){const t=e.ngIf,i=c.dc(15);c.xb(3),c.Zb("url",t.url)("descricao",t.description),c.xb(4),c.kc(t.description),c.xb(2),c.kc(t.likes),c.xb(2),c.kc(t.comments),c.xb(2),c.Zb("ngIf",t.allowComments)("ngIfElse",i)}}let U=(()=>{class t{constructor(t,e,i){this.animaisService=t,this.activatedRoute=e,this.router=i}ngOnInit(){this.animalId=this.activatedRoute.snapshot.params.animalId,this.animal$=this.animaisService.buscaPorID(this.animalId)}curtir(){this.animaisService.curtir(this.animalId).subscribe(t=>{t&&(this.animal$=this.animaisService.buscaPorID(this.animalId))})}excluir(){this.animaisService.excluiAnimal(this.animalId).subscribe(()=>{this.router.navigate(["/animais/"])},t=>console.log(t))}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(g),c.Hb(I.a),c.Hb(I.b))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-detalhe-animal"]],decls:2,vars:3,consts:[["class","bg-white border",4,"ngIf"],[1,"bg-white","border"],[1,"row"],[1,"col-lg-8"],[3,"url","descricao"],[1,"col-lg-4"],[1,"text-left","break-word"],[1,"fa","fa-heart-o","fa-2x","mr-2","pull-left",3,"click"],[1,"fa","fa-comment-o","fa-2x","mr-2","ml-2"],[1,"fa","fa-trash-o","fa-2x","pull-right",3,"click"],[3,"id",4,"ngIf","ngIfElse"],["warning",""],[3,"id"]],template:function(t,e){1&t&&(c.hc(0,H,16,7,"div",0),c.Ub(1,"async")),2&t&&c.Zb("ngIf",c.Vb(1,1,e.animal$))},directives:[r.l,K,D],pipes:[r.b],styles:[""]}),t})();function B(t,e){if(1&t&&(c.Kb(0,"h4",3),c.jc(1),c.Jb()),2&t){const t=c.Tb();c.xb(1),c.kc(t.titulo)}}const N=["*"];let M=(()=>{class t{constructor(){this.titulo=""}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Bb({type:t,selectors:[["app-cartao"]],inputs:{titulo:"titulo"},ngContentSelectors:N,decls:4,vars:1,consts:[[1,"card","border-light","text-center"],["class","card-header",4,"ngIf"],[1,"card-block","text-justify"],[1,"card-header"]],template:function(t,e){1&t&&(c.Yb(),c.Kb(0,"div",0),c.hc(1,B,2,1,"h4",1),c.Kb(2,"div",2),c.Xb(3),c.Jb(),c.Jb()),2&t&&(c.xb(1),c.Zb("ngIf",e.titulo))},directives:[r.l],styles:[""]}),t})();function W(t,e){1&t&&(c.Kb(0,"p",3),c.jc(1," Desculpe n\xe3o h\xe1 animais\n"),c.Jb())}const q=function(t){return["/animais",t]};function G(t,e){if(1&t&&(c.Kb(0,"div",4),c.Kb(1,"a",5),c.Kb(2,"app-cartao"),c.Ib(3,"app-animal",6),c.Kb(4,"i",7),c.jc(5),c.Jb(),c.Kb(6,"i",8),c.jc(7),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t){const t=e.$implicit;c.xb(1),c.Zb("routerLink",c.bc(5,q,t.id)),c.xb(2),c.Zb("url",t.url)("descricao",t.description),c.xb(2),c.kc(t.likes),c.xb(2),c.lc(" ",t.comments," ")}}let V=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Bb({type:t,selectors:[["app-grade-fotos-animais"]],inputs:{animais:"animais"},decls:3,vars:2,consts:[["class","text-center text-muted",4,"ngIf"],[1,"row"],["class","col-4",4,"ngFor","ngForOf"],[1,"text-center","text-muted"],[1,"col-4"],[3,"routerLink"],[3,"url","descricao"],["aria-hidden","true",1,"fa","fa-heart-o","fa-1x","mr-2"],["aria-hidden","true",1,"fa","fa-comment-o","fa-1x","mr-2","ml-2"]],template:function(t,e){1&t&&(c.hc(0,W,2,0,"p",0),c.Kb(1,"div",1),c.hc(2,G,8,7,"div",2),c.Jb()),2&t&&(c.Zb("ngIf",!e.animais.length),c.xb(2),c.Zb("ngForOf",e.animais))},directives:[r.l,r.k,I.c,M,K],styles:[""]}),t})(),Y=(()=>{class t{constructor(t){this.activatedRoute=t}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.animais$=this.activatedRoute.snapshot.data.animais})}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(I.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-lista-animais"]],decls:1,vars:1,consts:[[3,"animais"]],template:function(t,e){1&t&&c.Ib(0,"app-grade-fotos-animais",0),2&t&&c.Zb("animais",e.animais$)},directives:[V],styles:[""]}),t})();var z=i("IzEk"),_=i("7oKD");const Q=[{path:"",component:Y,resolve:{animais:(()=>{class t{constructor(t,e){this.animaisService=t,this.usuarioService=e}resolve(t,e){return this.usuarioService.retornaUsuario().pipe(Object($.a)(t=>{var e;const i=null!==(e=t.name)&&void 0!==e?e:"";return this.animaisService.listaDoUsuario(i)}),Object(z.a)(1))}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(g),c.Ob(_.a))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}},{path:"novo",component:Z},{path:":animalId",component:U}];let X=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[I.d.forChild(Q)],I.d]}),t})(),tt=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[r.c]]}),t})(),et=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[r.c,X,tt,n.a]]}),t})()}}]);